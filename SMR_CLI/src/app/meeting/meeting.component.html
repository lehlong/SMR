<div class="main-meet">
  <div class="meet-control">
    <div class="item-control">
      <nz-icon class="icon-resize" nzType="home" nzTheme="outline" />
    </div>
    <div class="item-control">
      <nz-icon class="icon-resize" nzType="video-camera" nzTheme="outline" />
    </div>
    <div class="item-control">
      <nz-icon class="icon-resize" nzType="comment" nzTheme="outline" />
    </div>
    <div class="item-control">
      <nz-icon class="icon-resize" nzType="file" nzTheme="outline" />
    </div>
    <div class="item-control">
      <nz-icon class="icon-resize" nzType="setting" nzTheme="outline" />
    </div>
    <div class="item-control">
      <nz-icon class="icon-resize" nzType="logout" nzTheme="outline" style="color: #dc3545;" />
    </div>
  </div>
  <div class="meet-container">
    <nz-tabset nzType="card" (nzSelectedIndexChange)="onTabChange($event)" nzCentered>
      <!-- Tab Thông tin -->
      <nz-tab [nzTitle]="ttch">
        <ng-template #ttch>
          <nz-icon nzType="info-circle" /> Thông tin cuộc họp
        </ng-template>
        <nz-page-header nzTitle="Cuộc họp về việc triển khai phần mềm" [nzSubtitle]="subtt">
          <ng-template #subtt>
            <nz-tag nzColor="green">Đang diễn ra</nz-tag>
            <nz-tag nzColor="default">Đã kết thúc</nz-tag>
          </ng-template>
          <nz-page-header-content>
            <div nz-row [nzGutter]="16" class="grid-header">
              <div nz-col class="gutter-row" [nzSpan]="4" class="card-sub-title-1">
                <div class="inner-box">
                  <nz-icon class="icon-resize" nzType="user" nzTheme="outline" />
                  <div class="sub-title-small">Người chủ trì</div>
                  <div class="sub-title">Lê Hải Long</div>
                </div>
              </div>
              <div nz-col class="gutter-row" [nzSpan]="4" class="card-sub-title-2">
                <div class="inner-box">
                  <nz-icon class="icon-resize" nzType="clock-circle" nzTheme="outline" />
                  <div class="sub-title-small">Thời gian</div>
                  <div class="sub-title">16/04/2025 14:00</div>
                </div>
              </div>
              <div nz-col class="gutter-row" [nzSpan]="4" class="card-sub-title-3">
                <div class="inner-box">
                  <nz-icon class="icon-resize" nzType="usergroup-add" nzTheme="outline" />
                  <div class="sub-title-small">Số người tham gia</div>
                  <div class="sub-title">10</div>
                </div>
              </div>
              <div nz-col class="gutter-row" [nzSpan]="8" class="card-sub-title-4">
                <div class="inner-box">
                  <nz-icon class="icon-resize" nzType="environment" nzTheme="outline" />
                  <div class="sub-title-small">Địa điểm</div>
                  <div class="sub-title">Phòng họp công ty D2S</div>
                </div>
              </div>
            </div>
          </nz-page-header-content>
          <nz-page-header-content style="margin-top: 12px;">

            <div nz-row [nzGutter]="16" class="grid-header">
              <div nz-col class="gutter-row" [nzSpan]="8" class="tb">
                <div class="inner-box">
                  <nz-card nzTitle="THIẾT BỊ TRONG PHÒNG HỌP">

                    <div nz-card-grid>
                      <div>
                        <img src="img/television.png" class="icon-img" />
                      </div>
                      <div>
                        <div>Màn hình</div>
                        <div style="font-size: 14px; color: gray;">Số lượng : 32</div>
                        <div><nz-tag nzColor="success">Hoạt động</nz-tag></div>
                      </div>
                    </div>

                    <div nz-card-grid>
                      <div>
                        <img src="img/tablet.png" class="icon-img" />
                      </div>
                      <div>
                        <div>Máy tính bảng</div>
                        <div style="font-size: 14px; color: gray;">Số lượng : 32</div>
                        <div><nz-tag nzColor="success">Hoạt động</nz-tag></div>
                      </div>
                    </div>

                    <div nz-card-grid>
                      <div>
                        <img src="img/air-conditioner.png" class="icon-img" />
                      </div>
                      <div>
                        <div>Điều hoà</div>
                        <div style="font-size: 14px; color: gray;">Số lượng : 32</div>
                        <div><nz-tag nzColor="success">Hoạt động</nz-tag></div>
                      </div>
                    </div>

                    <div nz-card-grid>
                      <div>
                        <img src="img/energy.png" class="icon-img" />
                      </div>
                      <div>
                        <div>Ánh sáng</div>
                        <div style="font-size: 14px; color: gray;">Số lượng : 32</div>
                        <div><nz-tag nzColor="success">Hoạt động</nz-tag></div>
                      </div>
                    </div>

                    <div nz-card-grid>
                      <div>
                        <img src="img/sound.png" class="icon-img" />
                      </div>
                      <div>
                        <div>Âm thanh</div>
                        <div style="font-size: 14px; color: gray;">Số lượng : 32</div>
                        <div><nz-tag nzColor="success">Hoạt động</nz-tag></div>
                      </div>
                    </div>

                    <div nz-card-grid>
                      <div>
                        <img src="img/micro.png" class="icon-img" />
                      </div>
                      <div>
                        <div>Micro</div>
                        <div style="font-size: 14px; color: gray;">Số lượng : 32</div>
                        <div><nz-tag nzColor="success">Hoạt động</nz-tag></div>
                      </div>
                    </div>

                  </nz-card>
                </div>
              </div>
              <div nz-col class="gutter-row" [nzSpan]="8">
                <div class="inner-box">
                  <nz-divider nzText="SƠ ĐỒ PHÒNG HỌP"></nz-divider>
                  <img src="img/room.jpg" style="width: 100%;" />
                </div>
              </div>

              <div nz-col class="gutter-row" [nzSpan]="8">
                <div class="inner-box">
                  <nz-table #basicTable [nzData]="[{}]">
                    <thead>
                      <tr>
                        <th></th>
                        <th>Thành viên</th>
                        <th>Online</th>
                        <th>Trạng thái</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>1</td>
                        <td>Nguyễn Văn A</td>
                        <td><nz-tag nzColor="success">Online</nz-tag></td>
                        <td><nz-tag nzColor="success">Đã tham gia</nz-tag></td>
                      </tr>
                      <tr>
                        <td>2</td>
                        <td>Nguyễn Văn A</td>
                        <td><nz-tag nzColor="success">Online</nz-tag></td>
                        <td></td>
                      </tr>
                      <tr>
                        <td>3</td>
                        <td>Nguyễn Văn A</td>
                        <td><nz-tag nzColor="error">Offline</nz-tag></td>
                        <td><nz-tag nzColor="success">Đã tham gia</nz-tag></td>
                      </tr>
                      <tr>
                        <td>4</td>
                        <td>Nguyễn Văn A</td>
                        <td><nz-tag nzColor="success">Online</nz-tag></td>
                        <td></td>
                      </tr>
                      <tr>
                        <td>5</td>
                        <td>Nguyễn Văn A</td>
                        <td><nz-tag nzColor="success">Online</nz-tag></td>
                        <td></td>
                      </tr>
                      <tr>
                        <td>6</td>
                        <td>Nguyễn Văn A</td>
                        <td><nz-tag nzColor="success">Online</nz-tag></td>
                        <td></td>
                      </tr>
                      <tr>
                        <td>7</td>
                        <td>Nguyễn Văn A</td>
                        <td><nz-tag nzColor="success">Online</nz-tag></td>
                        <td></td>
                      </tr>
                    </tbody>
                  </nz-table>
                </div>
              </div>
            </div>

          </nz-page-header-content>
        </nz-page-header>
      </nz-tab>

      <nz-tab [nzTitle]="tv">
        <ng-template #tv>
          <nz-icon nzType="usergroup-add" /> Thành viên
        </ng-template>

        <div nz-row [nzGutter]="16" class="grid-header">
          <div nz-col class="gutter-row p-0" [nzSpan]="6">
            <div class="inner-box">
              <div class="list-user-chat">
                <div class="item-user-chat" *ngFor="let i of [1,2,3,4,5,6]  let idx = index"
                [class.active]="selectedMessage === idx"
                (click)="selectMessage(idx)">
                  <div>
                    <nz-badge nzDot>
                      <nz-avatar nzIcon="user"></nz-avatar>
                    </nz-badge>
                  </div>
                  <div>
                    <div>Lê Hải Long</div>
                    <div class="last-message">Tin nhắn xem trước</div>
                  </div>
                  <div style="margin-left: auto;">
                    <nz-icon nzType="audio" nzTheme="outline" />

                  </div>
                  <div>
                    <nz-icon nzType="sound" nzTheme="outline" />
                  </div>
                </div>
              </div>

            </div>
          </div>
          <div nz-col class="gutter-row p-0" [nzSpan]="14">
            <div class="inner-box">
              <div class="chat-box">
                <div class="chat-header">
                  <nz-avatar nzIcon="user"></nz-avatar>
                  <div class="chat-header-title">Lê Hải Long</div>
                </div>
                <div #chatContent class="chat-content">
                  <div class="message-item-right">Tin nhắn của bạn</div>
                  <div class="message-item-left">Tin nhắn của người khác</div>
                  <div class="message-item-right">Tin nhắn của bạn ljkwerh lkwer hkwe rklwerhlsadf j'la;dsjrf q[wper qow'eri qoweri q;we </div>
                  <div class="message-item-left">Tin nhắn của ngườrei kháciower woeiru ow erouw er ower uypw erpow erpwe rpoiwery ipwer pwier ipuweyr iuweyr</div>
                  <div class="message-item-right">Tin nhắn của bạn</div>
                  <div class="message-item-left">Tin nhắn của người khác</div>
                  <div class="message-item-right">Tin nhắn của bạn</div>
                  <div class="message-item-left">Tin nhắn của người kwerwerhác</div>
                  <div class="message-item-right">Tin nhắn của bạn</div>
                  <div class="message-item-left">Tin nhắn của người khác</div>
                  <div class="message-item-right">Tin nhắn của bạn</div>
                  <div class="message-item-left">Tin nhắn của người khác</div>
                  <div class="message-item-right">Tin nhắn của bạn</div>
                  <div class="message-item-left">Tin nhắn của người khác</div>
                  <div class="message-item-right">Tin nhắn của bạn</div>
                  <div class="message-item-left">Tin nhắn của người khác</div>
                  <div class="message-item-right">Tin nhắn của bạn</div>
                  <div class="message-item-left">Tin nhắn của người khác</div>
                </div>
                <div class="chat-input">
                  <nz-input-group [nzSuffix]="suffixIconSearch">
                    <input type="text" nz-input placeholder="Nhập tin nhắn..." />
                  </nz-input-group>
                  <ng-template #suffixIconSearch>
                    <nz-icon nzType="send" />
                  </ng-template>
                </div>

              </div>

            </div>
          </div>
          <div nz-col class="gutter-row" [nzSpan]="4">
            <div class="inner-box">
              <div class="user-control">

              </div>
            </div>
          </div>
        </div>
      </nz-tab>

      <nz-tab [nzTitle]="bq">
        <ng-template #bq>
          <nz-icon nzType="line-chart" /> Biểu quyết
        </ng-template>
      </nz-tab>

      <!-- Tab Văn bản -->
      <nz-tab [nzTitle]="vb">
        <ng-template #vb>
          <nz-icon nzType="file" /> Văn bản
        </ng-template>
        <div style="padding: 0 12px;height: calc(100vh - 48px);">
          <div nz-row [nzGutter]="16">
            <div nz-col class="gutter-row" [nzSpan]="18">
              <div class="inner-box">
                <nz-tabset [(nzSelectedIndex)]="selectedIndex" nzType="editable-card" (nzClose)="closeTab($event)"
                  nzHideAdd>
                  <ng-container *ngFor="let tab of tabs; trackBy: trackByTabId">
                    <nz-tab [nzClosable]="true" [nzTitle]="tab.title">
                      <document-editor [id]="tab.id" [documentServerUrl]="'http://sso.d2s.com.vn:1239'"
                        [config]="tab.config" [events_onDocumentReady]="onDocumentReady"
                        [onLoadComponentError]="onLoadComponentError"></document-editor>
                    </nz-tab>
                  </ng-container>
                </nz-tabset>
              </div>
            </div>
            <div nz-col class="gutter-row" [nzSpan]="6">
              <div class="inner-box">
                <div class="list-document">

                  <nz-tabset nzType="card" nzCentered>
                    <nz-tab [nzTitle]="vbch">
                      <ng-template #vbch>
                        <nz-icon nzType="copy" /> Văn bản
                      </ng-template>
                      <nz-list nzItemLayout="horizontal">
                        <nz-list-item class="documents-item" (click)="newTab('Báo cáo tổng kết năm 2025.docx')">
                          <nz-list-item-meta nzAvatar="img/word.png" nzDescription="Báo cáo tổng kết năm 2025.docx">
                          </nz-list-item-meta>
                        </nz-list-item>

                        <nz-list-item class="documents-item"
                          (click)="newTab('Tài liệu hướng dẫn sử dụng phần mềm SMR.xlsx')">
                          <nz-list-item-meta nzAvatar="img/excel.png"
                            nzDescription="Tài liệu hướng dẫn sử dụng phần mềm SMR.xlsx">
                          </nz-list-item-meta>
                        </nz-list-item>

                        <nz-list-item class="documents-item" (click)="newTab('Báo cáo tổng kết năm 2025.pdf')">
                          <nz-list-item-meta nzAvatar="img/pdf.png" nzDescription="Báo cáo tổng kết năm 2025.pdf">
                          </nz-list-item-meta>
                        </nz-list-item>

                        <nz-list-item class="documents-item" (click)="newTab('Các tài liệu liên quan đến cuộc họp.txt')">
                          <nz-list-item-meta nzAvatar="img/documents.png"
                            nzDescription="Các tài liệu liên quan đến cuộc họp.txt">
                          </nz-list-item-meta>
                        </nz-list-item>
                      </nz-list>
                    </nz-tab>
                    <nz-tab [nzTitle]="Eoffice">
                      <ng-template #Eoffice>
                        <nz-icon nzType="code-sandbox" /> Eoffice
                      </ng-template>
                    </nz-tab>
                  </nz-tabset>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nz-tab>

      <!-- Tab Trình chiếu -->
      <nz-tab [nzTitle]="tc">
        <ng-template #tc>
          <nz-icon nzType="video-camera" /> Trình chiếu
        </ng-template>

        <div #jitsiContainer id="jitsi-container" style="height: calc(100vh - 54px); padding: 4px 0 0 0px;">
        </div>
      </nz-tab>

      <nz-tab [nzTitle]="aihd">
        <ng-template #aihd>
          <nz-icon nzType="open-a-i" /> AI hỏi đáp
        </ng-template>
        <div class="chat-ai">
          <div class="chat-ai-content" *ngIf="chatAi.length == 0">
            <div class="chat-ai-empty">
              <img src="img/chatbot.png" width="66" />
              <div class="chat-ai-title">Xin chào! Tôi có thể giúp gì cho bạn?</div>
            </div>
          </div>


          <div #chatContent class="chat-ai-content" *ngIf="chatAi.length != 0">
            @for (data of chatAi; track data) {
            <div *ngIf="data.role == 'User'" class="message-item-right">{{data.content}}</div>
            <div *ngIf="data.role == 'DeepSeek'" class="message-item-left" [innerHTML]="data.content"></div>
            }

          </div>
          <div class="chat-ai-input">
            <nz-input-group [nzSuffix]="suffixIconSearch">
              <input type="text" nz-input placeholder="Hỏi bất cứ điều gì..." [(ngModel)]="inputChatbot"
                (keydown.enter)="onAskChatbot()" />
            </nz-input-group>
            <ng-template #suffixIconSearch>
              <nz-icon nzType="send" />
            </ng-template>

          </div>
        </div>
      </nz-tab>

      <nz-tab [nzTitle]="dt">
        <ng-template #dt>
          <nz-icon nzType="translation" /> Dịch thuật
        </ng-template>
      </nz-tab>
    </nz-tabset>
  </div>
</div>
